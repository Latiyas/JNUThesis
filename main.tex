%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Author: Ming Li
%% Time: 2022-7-18
%% Note: Overleaf版本
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Author: Yongtao Zhou <y.t.zhou@foxmail.com>                            %%
%% Time: 2015-4-8                                                         %%
%% Note: 请保留原作者Yongtao Zhou信息，非官方模板。                            %%
%%       最终解释权和所有权利归原作者和数据存储与集群计算实验室所有。               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\PassOptionsToPackage{quiet}{fontspec}      %% 抑制fontspec警告 
\documentclass[a4paper,oneside,12pt]{book}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amscd}
\usepackage{amsfonts,eucal}
\usepackage{amsthm}
\usepackage{cite}
\usepackage{bm}
\usepackage[UTF8,fontset=none,heading=true]{ctex}
\usepackage{times}
%% 默认算法环境
\usepackage[linesnumbered,ruled,vlined,boxed,commentsnumbered]{algorithm2e}
%% 常用包
\usepackage{textcomp, gensymb}
\usepackage{graphicx}
\usepackage{url}
\usepackage{multirow}
\usepackage{subfig}
\usepackage{float}
\usepackage{subfig}
\usepackage{array}
\usepackage{amsmath}            %% equation mutilrow align
\usepackage{amsthm}
\usepackage{makecell}
\usepackage{rotating}
\usepackage{booktabs}
\usepackage{algorithm2e}
\usepackage{diagbox}
\usepackage{booktabs}
%% 用geometry宏包设置页边距
\usepackage[top=2.5cm,bottom=2.0cm,left=2.5cm,right=2.5cm]{geometry}
%% 用titlesec宏包设置章节标题
%% 用titletoc宏包设置章页眉页脚和目录的格式
\usepackage[indentafter, pagestyles]{titlesec}
\usepackage{titletoc}
\usepackage{etoolbox}
\usepackage{indentfirst}
\setlength{\parindent}{2em}     %% 2em代表首行缩进两个字符
%% latex超链接
\usepackage{hyperref}

%% 引入书签
\hypersetup{hidelinks,
	colorlinks=true,
	allcolors=black,
	pdfstartview=Fit,
	breaklinks=true
}

%% 用\titleformat命令设置章标题的格式
\titleformat{\chapter}[hang]{\centering\xiaosan\hei}{\thechapter}{1em}{}
\titleformat{\section}[hang]{\sihao\hei}{\thesection}{0.5em}{}
\titleformat{\subsection}[hang]{\xiaosi\hei}{\thesubsection}{0.5em}{}

%% 用\titlespacing或\titlespacing*命令设置标题与四周的距离
\titlespacing{\chapter}{0pt}{*0}{*5}
\titlespacing{\section}{0pt}{*1}{*1}
\titlespacing{\subsection}{0pt}{*0.5}{*0.5}

% %% 重置默认字体--小四
% \renewcommand{\normalsize}{\fontsize{12pt}{14.4pt}\selectfont}

%% 行距倍数
% \renewcommand{\baselinestretch}{1.5}
\renewcommand{\baselinestretch}{1.625}
%% 段落间距
% \setlength{\parskip}{0.3\baselineskip}
\setlength{\parskip}{0\baselineskip}
%% 汉字字距
\renewcommand{\CJKglue}{\hskip 1pt plus 0.08\baselineskip}
%% 重新设置字体大小，行高 = 字体大小 * 1.2
\newcommand{\wuhao}{\fontsize{10.5pt}{12.6pt}\selectfont}          %% 五号字体
\newcommand{\xiaosi}{\fontsize{12pt}{14.4pt}\selectfont}           %% 小四字体
\newcommand{\sihao}{\fontsize{14pt}{16.8pt}\selectfont}            %% 四号字体
\newcommand{\xiaosan}{\fontsize{15pt}{18pt}\selectfont}            %% 小三字体
\newcommand{\sanhao}{\fontsize{16pt}{19.2pt}\selectfont}           %% 三号字体
\newcommand{\xiaoer}{\fontsize{18pt}{21.6pt}\selectfont}           %% 小二字体
\newcommand{\erhao}{\fontsize{22pt}{26.4pt}\selectfont}            %% 二号字体

%% 重设目录设置
\setcounter{tocdepth}{1}
\titlecontents{chapter}[0pt]{\vspace{0pt}\song\xiaosi}
    {\thecontentslabel\hspace{1em}}{}
    {\hspace{0em}\titlerule*[3pt]{$\cdot$}\contentspage}
\titlecontents{section}[0pt]{\vspace{0pt}\hspace{1em}\song\xiaosi}
    {\thecontentslabel\hspace{1em}}{}
    {\hspace{0em}\titlerule*[3pt]{$\cdot$}\contentspage}
\titlecontents{subsection}[0pt]{\vspace{0pt}\song\xiaosi}
    {\thecontentslabel\hspace{1em}}{}
    {\hspace{0em}\titlerule*[3pt]{$\cdot$}\contentspage}

% %% 设置字体大小
% \newcommand{\wuhao}{\fontsize{10.5pt}{12.6pt}\selectfont}        %% 五号字体
% \newcommand{\xiaosi}{\fontsize{12pt}{18pt}\selectfont}           %% 小四字体
% \newcommand{\sihao}{\fontsize{14pt}{21pt}\selectfont}            %% 四号字体
% \newcommand{\xiaosan}{\fontsize{15pt}{22.5pt}\selectfont}        %% 小三字体
% \newcommand{\sanhao}{\fontsize{16pt}{24pt}\selectfont}           %% 三号字体
% \newcommand{\xiaoer}{\fontsize{18pt}{27pt}\selectfont}           %% 小二字体
% \newcommand{\erhao}{\fontsize{22pt}{30pt}\selectfont}            %% 二号字体

% %% 目录设置
% \setcounter{tocdepth}{1}
% \titlecontents{chapter}[0pt]{\vspace{-15pt}\song\xiaosi}
%     {\thecontentslabel\hspace{1em}}{}
%     {\hspace{0em}\titlerule*[3pt]{$\cdot$}\contentspage}
% \titlecontents{section}[0pt]{\vspace{-15pt}\hspace{1em}\song\xiaosi}
%     {\thecontentslabel\hspace{1em}}{}
%     {\hspace{0em}\titlerule*[3pt]{$\cdot$}\contentspage}
% \titlecontents{subsection}[4em]{\vspace{-15pt}\song\xiaosi}
%     {\thecontentslabel\hspace{1em}}{}
%     {\hspace{0em}\titlerule*[3pt]{$\cdot$}\contentspage}

%% 设置中文字体
%% 加载本地中文字体
\setCJKfamilyfont{song}{simsun.ttc}[AutoFakeSlant,AutoFakeBold={2}]     %% 宋体
\newcommand{\song}{\CJKfamily{song}}                                    %% 宋体
\setCJKfamilyfont{hei}{simhei.ttf}[AutoFakeSlant,AutoFakeBold={2}]      %% 黑体
\newcommand{\hei}{\CJKfamily{hei}}                                      %% 黑体
\setCJKfamilyfont{kai}{simkai.ttf}[AutoFakeSlant,AutoFakeBold={2}]      %% 楷体
\newcommand{\kai}{\CJKfamily{kai}}                                      %% 楷体
\setCJKfamilyfont{li}{SIMLI.TTF}[AutoFakeSlant,AutoFakeBold={2}]        %% 隶书
\newcommand{\li}{\CJKfamily{li}}                                        %% 隶书

%%% 如需加载其他中文字体，可以从网上或者C:\Windows\Fonts复制字体文件到根目录下加载即可。
%% \newcommand{\fs}{\CJKfamily{fs}}        %% 仿宋
%% \newcommand{\you}{\CJKfamily{you}}      %% 幼圆
\setCJKmainfont{simsun.ttc}[AutoFakeSlant,AutoFakeBold={2}]

%% 设置英文字体
\RequirePackage{xltxtra}                %% \XeTeX Logo
\setmainfont{Times New Roman}
\setsansfont{Arial}
\setmonofont{Times New Roman}

\newcommand*\aap{Astronomy \& Astrophysics}
\let\astap=\aap
\newcommand*\aaps{American Association of Pharmaceutical Scientists}
\newcommand*\aj{Astronomical Journal}
\let\applopt\ao
\newcommand*\apj{Astrophysical Journal}
\newcommand*\apjl{Astrophysical Journal Letters}
\let\apjlett\apjl
\newcommand*\apjs{Astronomical Journal Supplementary Series}
\let\apjsupp\apjs
\newcommand*\aplett{Astrophys.~Lett.}
\newcommand*\apspr{Astrophys.~Space~Phys.~Res.}
\newcommand*\apss{Astrophysics and Space Science}
\newcommand*\caa{Chinese Astron. Astrophys.}
\newcommand*\cjaa{Chinese J. Astron. Astrophys.}
\newcommand*\icarus{Icarus}
\newcommand*\mnras{MNRAS}
\newcommand*\na{New A}
\newcommand*\nar{New A Rev.}
\newcommand*\nat{Nature}
\newcommand*\pasa{Publications of The Astronomical Society of Australia}
\newcommand*\pasj{Publications of The Astronomical Society of Japan}
\newcommand*\pasp{Publications of The Astronomical Society of The Pacific}
\newcommand*\planss{Planetary and Space Science}
\newcommand*\ssr{Space Science Reviews}

%% 设置页眉页脚
\newpagestyle{main}[\wuhao]{
\sethead{}{\pageHeaderTitle}{}
\setfoot{}{\thepage}{} \setheadrule{0.05pt}}\pagestyle{main}

%% 重置目录的名称
\renewcommand{\contentsname}{目\qquad 录}

%% 算法环境的重置
\renewcommand{\algorithmcfname}{算法}
\SetKwInput{KwData}{输入}
\SetKwInput{KwResult}{输出}

%% 图表重置
%% 设置公式的编号为短杠形式
\renewcommand\theequation{%
\thechapter-\arabic{equation}}
%% 设置图, 表的编号为短杠形式
\renewcommand\thefigure{\arabic{chapter}-\arabic{figure}}
\renewcommand\thetable{\arabic{chapter}-\arabic{table}}
%% 设置控制标签与标题之间的间隔形式
\renewcommand{\figurename}{图}
\renewcommand{\tablename}{表}
\usepackage[labelsep=space]{caption}

%% 中文和英文之间加入波浪符“~”，或“ \ ”
%% 例如：中文~abc~中文
%% 中英文混排的时候是用中文标点还是英文标点呢？
%% 这并没有统一的规范。不过比较合理也比较通行的做法是
%% 中文后用中文标点，英文后用英文标点
%% 一般数学文章习惯用全角的实心句点作为中文句号
%% 全角的中文括号看起来不太好看，可以统一使用英文的括号
%% 左括号前面和右括号后面最好加上波浪符“~”
%% 在缩写词后面加上波浪符“~”，如 pp.~100, cf.~something
%% 定义符合中文习惯的定理环境
\newtheoremstyle{mythm}{1.5ex plus 1ex minus .2ex}{1.5ex plus 1ex minus .2ex}{\kai}{\parindent}{\song\bfseries}{}{1em}{}
\theoremstyle{mythm}
\newtheorem{thm}{定理~}[chapter]
\newtheorem{lem}{引理~}
\newtheorem{prop}{命题~}
\newtheorem{cor}{推论~}
\newtheorem{defn}{定义~}
\newtheorem{conj}{猜想~}
\newtheorem{exmp}{例~}
\newtheorem{rem}{注~}
\newtheorem{notation}{记号~}

\newtheoremstyle{specthm}{1.5ex plus 1ex minus .2ex}{1.5ex plus 1ex minus .2ex}{\kai}{\parindent}{\song\bfseries}{}{1em}{\thmnote{#3}}
\theoremstyle{specthm}
\newtheorem{sthm}[thm]{}
%% 例如：
%% \begin{sthm}[定理~\thethm~(存在性定理)]
%% 定理内容
%% \end{sthm}
%% 定义符合中文习惯的证明环境
\makeatletter
\renewenvironment{proof}[1][\proofname]{\par
    \pushQED{\qed}%
    \normalfont \topsep6\p@\@plus6\p@ \labelsep1em\relax
    \trivlist
    \item[\hskip\labelsep\indent
        \bfseries #1]\ignorespaces
}{%
    \popQED\endtrivlist\@endpefalse
}
\makeatother


%% 将文献引用作为上标出现
\makeatletter
\def\@cite#1#2{\textsuperscript{[{#1\if@tempswa , #2\fi}]}}
\makeatother

%% 修改图表目录的指引线距离
\makeatletter
\def\@dotsep{1} % 默认是4.5，就是点之间距离为4.5mu。可以改成2
\makeatother

\renewcommand{\proofname}{证明}
%% proof环境会自动在证明最后一行的最右边加上一个证明结束符
%% 默认为空心方块，可以重新定义 \qedsymbol 来修改它
%% 需要注意的是，当证明以一个独立公式结束时
%% 证明结束符会出现在下一行的最右边，而不是在公式的同一行上
%% 这不合乎习惯。这时只要在公式环境内加上 \qedhere 即可

% Added Library
\input{chapter/Lib}

\begin{document}
%% 参考文献格式重置，重置参考文献的名称
\def\thebibliography#1{\chapter*{参\ 考\ 文\ 献}
    \addcontentsline{toc}{chapter}{参考文献}
    \thispagestyle{main}
    \list
    {[\arabic{enumi}]}{\settowidth\labelwidth{[#1]}\leftmargin\labelwidth
    \advance\leftmargin\labelsep
    \usecounter{enumi}}
    \def\newblock{\hskip .11em plus .33em minus .07em}
    \sloppy\clubpenalty4000\widowpenalty4000
    \sfcode`\.=1000\relax
}

%% 修改参考文献条目之间的竖直方向上的距离
\patchcmd{\thebibliography}{\leftmargin\labelwidth}{\leftmargin\labelwidth\addtolength\itemsep{-8pt}}{}{}

%% 前言
\include{chapter/declaration}

%% 摘要
\include{chapter/abstract}

%% 生成目录
\tableofcontents
\thispagestyle{main}

%% 重置图/表目录(取消不同章之间的间隔)
\begingroup
	\renewcommand*{\addvspace}[1]{}
	\newcommand{\loflabel}{图} 
	\renewcommand{\numberline}[1]{\loflabel~#1\hspace*{1em}}
    \renewcommand{\listfigurename}{图目录}
	\listoffigures
	
	\newcommand{\lotlabel}{表}
	\renewcommand{\numberline}[1]{\lotlabel~#1\hspace*{1em}}
    \renewcommand{\listtablename}{表目录}
	\listoftables
\endgroup
% %%图目录
% \listoffigures
% \thispagestyle{main}
% %%表格目录.
% \listoftables
% \thispagestyle{main}

%% 正文
\mainmatter
%% 设置章节格式（一倍行距为字体大小 × 1.297(1.3) × 1.25）
\ctexset{chapter={
        name = {},
        number = {\arabic{chapter}},
        format = {\bfseries \sffamily \hei \centering \zihao{-3}},
        beforeskip = 15pt,
        afterskip = 25pt,
        fixskip = true,
        aftername = ~~~~,
    }
}
%% 设置一级章节格式
\ctexset{section={
        format = {\bfseries \sffamily \hei \raggedright \zihao{4}},
        beforeskip = 25pt,
        afterskip = 20pt,
        fixskip = true,
    }
}
%% 设置二级标题格式 
\ctexset{subsection={
        format = {\bfseries \sffamily \hei \raggedright \zihao{-4}},
        beforeskip = 20pt,
        afterskip = 20pt,
        fixskip = true,
    }
}
%% 设置三节标题格式
\ctexset{subsubsection={
        format = {\bfseries \sffamily \hei \raggedright \zihao{-4}},
        beforeskip = 20pt,
        afterskip = 20pt,
        fixskip = true,
    }
}

%% 论文正文部分，在chaps.tex内编辑
\input{chapter/chaps}

%% 结论
\include{chapter/conclusion}

%% 攻读学位期间发表的论文
\include{chapter/paper}

%% 参考文献引入
%% 暨大参考文献设置
% \bibliographystyle{thubib}
% 参考文献设置-GB
\bibliographystyle{gbt7714-2005}
\bibliography{bib/refs}

%% 致谢
\include{chapter/acknowledgement}
%% 加入\newpage能使最后一页也有页眉
\newpage
\end{document}